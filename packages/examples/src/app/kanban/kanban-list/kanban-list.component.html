<div class="list" [class.list--drag-preview]="dragging">

    <!-- Attach to the h3 as a drag handle. The ItemTypes.LIST provided above is applied automatically. -->
    <ng-container *ngIf="source; else plain">
        <h3 [dragSource]="source" [noHTML5Preview]="true">{{list.title}}</h3>
    </ng-container>
    <ng-template #plain>
        <h3>{{list.title}}</h3>
    </ng-template>

    <skyhook-card-list class="cards-container" [listId]="list.id" [cards]="list.cards" (dropped)="dropCard.emit($event)"
        [type]="ItemTypes.CARD">

        <!-- No trickery with drag handles, just attach. -->
        <ng-template cardTemplate let-context>
            <kanban-card
                [cardRenderer]="context"
                #render="cardRenderer"
                [dropTarget]="render.target"
                [dragSource]="render.source"
                [noHTML5Preview]="true"
                [card]="context.card"
                [dragging]="render.isDragging"
                >
            </kanban-card>
        </ng-template>

        <ng-template placeholderTemplate let-context>
            <!-- Render this placeholder at exactly the same size as the card it is shadowing. -->
            <div [cardPlaceholder]="context"
                 class="card-placeholder"></div>
        </ng-template>

    </skyhook-card-list>

    <kanban-add-card (add)="addCard.emit($event)">
    </kanban-add-card>
</div>
