<skyhook-preview [allBackends]="true">
    <ng-template let-type let-item="item">
        <ng-container [ngSwitch]="type">
            <kanban-card *ngSwitchCase="ItemTypes.CARD" [card]="item.data" [dragging]="true" [ngStyle]="item.size.style()">
            </kanban-card>
            <kanban-list *ngSwitchCase="ItemTypes.LIST" [list]="item.data" [ngStyle]="item.size.style()">
            </kanban-list>
        </ng-container>
    </ng-template>
</skyhook-preview>

<!--
    This is the 'sugared' version.
    Use skyhook-card-list, and give it a template for how to
    render each element. It will handle creating the `*ngFor`
    for you, from the list the spec provides, and will help
    you pass context down to [cardRenderer].
--->

<skyhook-card-list class="kanban-root"
    [cardListId]="888"
    [cardListType]="ItemTypes.LIST"
    [cardListSpec]="boardSpec"
    [cardListHorizontal]="true">

    <ng-template cardTemplate let-context>
        <kanban-list
            [cardRenderer]="context"
            #render="cardRenderer"
            [list]="render.data"
            [source]="render.source"
            [placeholder]="render.isDragging$ | async"
            [spec]="listSpec"
            (addCard)="addCard(render.data.id, $event)">
            <!-- see how we made each kanban-list draggable?
                -  first, we attached the cardRenderer directive,
                   which needs some context (mostly data + index)
                -  we also grabbed a reference to it with #render="..."
                -  then, because cardRenderer doesn't know which DOM
                   element should be draggable, it lets us decide by
                   giving us `render.source`, a DragSource object that
                   is already configured.
                -  we don't actually attach render.source here; we
                   do it in kanban-list itself, on the list title. -->
        </kanban-list>
    </ng-template>

</skyhook-card-list>

<kanban-trash-can class="trash-zone" (dropped)="removeCard($event)">
</kanban-trash-can>
